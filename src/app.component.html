<div class="min-h-screen bg-slate-50 text-slate-800">
  <!-- Header -->
  <header class="bg-white shadow-md sticky top-0 z-10">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between">
      <div class="flex items-center space-x-3">
        <svg class="w-8 h-8 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6h1.5m-1.5 3h1.5m-1.5 3h1.5M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21" />
        </svg>
        <h1 class="text-2xl font-bold text-slate-900">Gemini Hotel Booker</h1>
      </div>
       @if (view() !== 'list') {
        <button (click)="goBackToList()" class="text-blue-600 hover:text-blue-800 transition-colors duration-200 font-medium">
          &larr; Back to Hotels
        </button>
      }
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
    @switch (view()) {
      <!-- HOTEL LIST VIEW -->
      @case ('list') {
        <div class="mb-8 max-w-2xl mx-auto">
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
              <svg class="w-5 h-5 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
              </svg>
            </div>
            <input 
              type="text" 
              placeholder="Search hotels by name or location..." 
              [value]="searchQuery()" 
              (input)="updateSearchQuery($event)" 
              class="block w-full pl-12 pr-4 py-3 border border-slate-300 rounded-full shadow-sm placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg">
          </div>
        </div>

        @if (filteredHotels().length > 0) {
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            @for (hotel of filteredHotels(); track hotel.id) {
              <div class="bg-white rounded-lg shadow-lg overflow-hidden transition-all duration-300 hover:shadow-2xl hover:-translate-y-1">
                <img [ngSrc]="hotel.imageUrl" [alt]="hotel.name" width="800" height="600" class="w-full h-56 object-cover">
                <div class="p-6">
                  <h2 class="text-2xl font-bold text-slate-900 mb-2">{{ hotel.name }}</h2>
                  <div class="flex items-center text-slate-600 mb-4">
                    <svg class="w-5 h-5 mr-2 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />
                      <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />
                    </svg>
                    <span>{{ hotel.location }}</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <div>
                      <span class="text-2xl font-bold text-blue-600">${{ hotel.pricePerNight }}</span>
                      <span class="text-slate-500">/night</span>
                    </div>
                    <button (click)="selectHotel(hotel.id)" class="bg-blue-600 text-white px-6 py-2 rounded-md font-semibold hover:bg-blue-700 transition-colors duration-200">
                      View Details
                    </button>
                  </div>
                </div>
              </div>
            }
          </div>
        } @else {
          <div class="text-center py-16">
            <h2 class="text-2xl font-semibold text-slate-700">No Hotels Found</h2>
            <p class="text-slate-500 mt-2">Try adjusting your search criteria.</p>
          </div>
        }
      }

      <!-- HOTEL DETAIL VIEW -->
      @case ('detail') {
        @if (selectedHotel(); as hotel) {
          <div class="bg-white rounded-lg shadow-xl overflow-hidden">
            <div class="grid grid-cols-1 lg:grid-cols-5 gap-0">
              <div class="lg:col-span-3">
                <img [ngSrc]="hotel.imageUrl" [alt]="hotel.name" width="800" height="600" class="w-full h-full object-cover min-h-[400px]">
              </div>
              <div class="lg:col-span-2 p-8 flex flex-col">
                <h2 class="text-4xl font-extrabold text-slate-900 mb-2">{{ hotel.name }}</h2>
                <p class="text-lg text-slate-500 mb-4">{{ hotel.location }}</p>
                <div class="flex items-center mb-6">
                  @for (i of [1, 2, 3, 4, 5]; track i) {
                    <svg class="w-6 h-6" [class]="i <= hotel.rating ? 'text-yellow-400' : 'text-slate-300'" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                    </svg>
                  }
                  <span class="ml-2 text-slate-600 font-semibold">{{ hotel.rating }} / 5</span>
                </div>
                
                <div class="mb-6">
                  @if (isDescriptionLoading()) {
                    <div class="space-y-2 animate-pulse">
                      <div class="h-4 bg-slate-200 rounded w-full"></div>
                      <div class="h-4 bg-slate-200 rounded w-5/6"></div>
                      <div class="h-4 bg-slate-200 rounded w-3/4"></div>
                    </div>
                  } @else {
                    <p class="text-slate-700 leading-relaxed">{{ geminiDescription() }}</p>
                  }
                </div>

                <div class="mb-6">
                   <h3 class="text-xl font-bold text-slate-800 mb-3">Amenities</h3>
                    <ul class="grid grid-cols-2 gap-x-4 gap-y-2 text-slate-700">
                      @for (amenity of hotel.amenities; track $index) {
                        <li class="flex items-center">
                          <svg class="w-5 h-5 mr-2 text-green-500 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                          <span>{{ amenity }}</span>
                        </li>
                      }
                    </ul>
                </div>

                <div class="mb-6">
                   <h3 class="text-xl font-bold text-slate-800 mb-3">Local Activities</h3>
                    @if (isActivitiesLoading()) {
                      <div class="space-y-2 animate-pulse">
                        <div class="h-4 bg-slate-200 rounded w-full"></div>
                        <div class="h-4 bg-slate-200 rounded w-5/6"></div>
                      </div>
                    } @else {
                      <ul class="space-y-2 text-slate-700">
                        @for (activity of geminiActivities(); track activity) {
                          <li class="flex items-start">
                            <svg class="w-5 h-5 mr-2 text-blue-500 mt-1 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" /></svg>
                            <span>{{ activity.substring(activity.indexOf('.') + 1).trim() }}</span>
                          </li>
                        }
                      </ul>
                    }
                </div>

                <div class="mt-auto pt-6 border-t border-slate-200 text-center">
                  <p class="text-3xl font-bold text-blue-600 mb-4">${{ hotel.pricePerNight }} <span class="text-lg font-normal text-slate-500">/night</span></p>
                  <button (click)="goToBooking()" class="w-full bg-blue-600 text-white py-3 rounded-lg font-bold text-lg hover:bg-blue-700 transition-colors duration-200">
                    Book Now
                  </button>
                </div>
              </div>
            </div>
          </div>
        }
      }

      <!-- BOOKING VIEW -->
      @case ('booking') {
        @if (selectedHotel(); as hotel) {
          <div class="max-w-4xl mx-auto bg-white p-8 rounded-lg shadow-xl">
            <h2 class="text-3xl font-bold text-slate-900 mb-2">Confirm Your Stay</h2>
            <p class="text-lg text-slate-600 mb-6">at <span class="font-semibold">{{ hotel.name }}</span></p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
              <!-- Calendar Column -->
              <div>
                <div class="grid grid-cols-2 gap-4 mb-4">
                  <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Check-in</label>
                    <div class="p-2 border border-slate-300 rounded-md bg-slate-50 text-center font-semibold">
                      {{ checkInDate()?.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) ?? 'Select date' }}
                    </div>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Check-out</label>
                     <div class="p-2 border border-slate-300 rounded-md bg-slate-50 text-center font-semibold">
                      {{ checkOutDate()?.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) ?? 'Select date' }}
                    </div>
                  </div>
                </div>

                <div class="bg-white rounded-lg">
                  <div class="flex items-center justify-between mb-2 px-2">
                    <button (click)="previousMonth()" class="p-2 rounded-full hover:bg-slate-100">
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                    </button>
                    <h3 class="text-lg font-semibold">{{ calendarDate().toLocaleString('default', { month: 'long', year: 'numeric' }) }}</h3>
                    <button (click)="nextMonth()" class="p-2 rounded-full hover:bg-slate-100">
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                    </button>
                  </div>
                  <div class="grid grid-cols-7 text-center text-xs text-slate-500 mb-2">
                    <span>Su</span><span>Mo</span><span>Tu</span><span>We</span><span>Th</span><span>Fr</span><span>Sa</span>
                  </div>
                  <div class="grid grid-cols-7">
                    @for (day of calendarDays(); track day.date) {
                       <button (click)="selectDate(day)" [disabled]="day.isPast"
                        class="relative w-10 h-10 flex items-center justify-center transition-colors duration-150"
                        [class.rounded-l-full]="isRangeSelected() && isCheckIn(day.date)"
                        [class.rounded-r-full]="isRangeSelected() && isCheckOut(day.date)"
                        [class.rounded-full]="!isRangeSelected() || (!isInRange(day.date) && !isCheckIn(day.date) && !isCheckOut(day.date))"
                        [class.text-slate-400]="!day.isCurrentMonth || day.isPast"
                        [class.cursor-not-allowed]="day.isPast"
                        [class.hover:bg-blue-100]="!day.isPast"
                        [class.bg-blue-600]="isCheckIn(day.date) || isCheckOut(day.date)"
                        [class.text-white]="isCheckIn(day.date) || isCheckOut(day.date)"
                        [class.bg-blue-100]="isInRange(day.date)"
                        [class.text-blue-700]="isInRange(day.date)"
                        >
                        {{ day.dayOfMonth }}
                      </button>
                    }
                  </div>
                </div>
              </div>

              <!-- Booking Summary Column -->
              <div>
                <div class="mb-6">
                  <label for="guests" class="block text-sm font-medium text-slate-700 mb-1">Guests</label>
                  <input id="guests" type="number" [value]="bookingGuests()" (input)="updateGuests($event)" min="1" max="5" class="w-full border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>

                <div class="bg-slate-50 rounded-lg p-6">
                  <h3 class="text-xl font-semibold text-slate-800 mb-4">Booking Summary</h3>
                  <div class="space-y-3">
                    @if (bookingNights() > 0) {
                      <div class="flex justify-between">
                        <span class="text-slate-600">{{ hotel.name }} ({{ bookingNights() }} night{{ bookingNights() > 1 ? 's' : '' }})</span>
                        <span class="font-medium text-slate-800">${{ hotel.pricePerNight * bookingNights() }}</span>
                      </div>
                      <div class="flex justify-between text-slate-600">
                        <span>Taxes & Fees</span>
                        <span class="font-medium text-slate-800">$0</span>
                      </div>
                      <div class="flex justify-between text-2xl font-bold text-slate-900 pt-3 border-t border-slate-200">
                        <span>Total</span>
                        <span>${{ totalCost() }}</span>
                      </div>
                    } @else {
                      <p class="text-slate-500 text-center">Please select your check-in and check-out dates.</p>
                    }
                  </div>
                </div>

                <button (click)="startPaymentProcess()" [disabled]="!checkInDate() || !checkOutDate()" class="mt-8 w-full flex justify-center items-center bg-[#00457C] text-white py-3 rounded-lg font-bold text-lg transition-colors duration-200 disabled:bg-slate-400 disabled:cursor-not-allowed" [class.hover:bg-[#003057]]="checkInDate() && checkOutDate()">
                  <svg class="w-6 h-6 mr-2" viewBox="0 0 24 24" fill="currentColor"><path d="M7.183 3.004h9.805c.338.005.668.14.912.373.244.233.38.555.385.888l-1.33 9.273c-.027.24-.135.46-.307.625-.172.164-.4.267-.64.267H5.33c-.338-.005-.668-.14-.912-.373s-.38-.555-.385-.888L5.36 4.265c.027-.24.135-.46.307.625.172-.164.4-.267.64-.267h.876Zm10.19 1.263H6.804l-.88 6.135c-.01.071.01.144.053.2.043.056.108.09.176.09h11.95c.13 0 .24-.11.235-.24l-1.155-8.055v-.13Zm-11.45 9.07h12.31c.338.005.668.14.912.373.244.233.38.555.385.888l-.88 6.135c-.027.24-.135.46-.307.625-.172.164-.4.267-.64.267H4.33c-.338-.005-.668-.14-.912-.373s-.38-.555-.385-.888l.88-6.135c.027-.24.135-.46.307.625.172-.164.4-.267.64-.267h.93Z"/></svg>
              Pay with PayPal
            </button>
              </div>
            </div>
          </div>
        }
      }

      <!-- PAYPAL MODAL VIEW -->
      @case ('paypal') {
        <div class="fixed inset-0 bg-black/60 backdrop-blur-sm z-40"></div>
        <div class="fixed inset-0 z-50 flex items-center justify-center p-4">
          @if(selectedHotel(); as hotel) {
            <div class="bg-white rounded-lg shadow-2xl w-full max-w-md relative animate-fade-in-up">
              <button (click)="goBackToBooking()" class="absolute top-2 right-2 text-slate-400 hover:text-slate-600 transition-colors" aria-label="Close PayPal">
                <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
              
              <!-- Header -->
              <div class="bg-slate-100 p-4 rounded-t-lg flex justify-center items-center border-b">
                <svg class="w-24" viewBox="0 0 128 34" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.364 21.606v-7.925c0-1.884.06-2.923.178-3.52.12-.6.38-1.1.782-1.5.402-.4.922-.68 1.562-.84.64-.16 1.54-.24 2.7-.24h2.18c.52 0 .92.08 1.2.24.28.16.48.4.6.72.12.32.18.7.18 1.14v.48h-4.34c-1.36 0-2.36.26-3.001.78-.64.52-.96 1.34-.96 2.46v6.926c0 1.12.32 1.94.96 2.46.64.52 1.64.78 3.001.78h4.82v-3.74h-2.58v-2.3h5.72v6.98c0 .48-.06.88-.18 1.2-.12.32-.32.56-.6.72-.28.16-.68.24-1.2.24h-2.961c-1.24 0-2.26-.08-3.061-.24-.8-.16-1.46-.44-1.98-.84-.52-.4-.9-.9-1.14-1.5-.24-.6-.36-1.64-.36-3.121Z" fill="#253B80"></path><path d="M32.065 21.606v-7.925c0-1.884.06-2.923.18-3.52.12-.6.38-1.1.78-1.5.4-.4.92-.68 1.56-.84.64-.16 1.54-.24 2.7-.24h2.18c.52 0 .92.08 1.2.24.28.16.48.4.6.72.12.32.18.7.18 1.14v.48h-4.34c-1.36 0-2.36.26-3.002.78-.64.52-.96 1.34-.96 2.46v6.926c0 1.12.32 1.94.96 2.46.64.52 1.64.78 3.002.78h4.82v-3.74h-2.58v-2.3h5.72v6.98c0 .48-.06.88-.18 1.2-.12.32-.32.56-.6.72-.28.16-.68.24-1.2.24h-2.96c-1.24 0-2.26-.08-3.06-.24-.8-.16-1.46-.44-1.98-.84-.52-.4-.9-.9-1.14-1.5-.24-.6-.36-1.64-.36-3.121Z" fill="#253B80"></path><path d="M60.667 9.846h-5.022l-4.521 16.2h3.94l.82-3.12h4.5l.44 3.12h3.84l-3.98-16.2Zm-2.76 10.56.24-1.02.94-3.66c.12-.48.22-.96.3-1.44h.06c.06.48.14.96.22 1.44l.96 3.66.24 1.02h-3Z" fill="#253B80"></path><path d="M2.583 3.326C1.943 3.486 1.403 3.826.963 4.346c-.44.52-.75 1.18-.93 1.98-.18.8-.27 1.78-.27 2.94v.9c0 1.52.32 2.8.96 3.84.64 1.04 1.62 1.56 2.94 1.56h.9v-1.74h-.72c-.88 0-1.52-.22-1.92-.66-.4-.44-.6-1.08-.6-1.92v-3.48h4.22v-2.82H1.383v-.6c0-.84.2-1.46.6-1.86s.98-.6 1.74-.6h.72v-1.74h-1.86Z" fill="#179BD7"></path><path d="M23.324 3.566c1.12 0 2.02.26 2.7.78.68.52 1.02 1.32 1.02 2.4v.42h-3.92c-1.2 0-2.1.28-2.7.84-.6.56-.9 1.42-.9 2.58v4.2c0 1.16.3 2.02.9 2.58.6.56 1.5.84 2.7.84h3.92v.42c0 1.08-.34 1.88-1.02 2.4-.68.52-1.58.78-2.7.78-1.04 0-1.9-.22-2.58-.66-.68-.44-1.12-1.02-1.32-1.74l-3.3.42c.44 1.44 1.28 2.54 2.52 3.3.24.16.5.28.78.38.28.08.58.14.88.16.3.02.6.02.9.02 1.76 0 3.16-.36 4.2-1.08 1.04-.72 1.56-1.8 1.56-3.24v-6.9c.28-.48.64-.86 1.08-1.14.44-.28.92-.42 1.44-.42h.36v-2.82h-.9c-.6 0-1.12.12-1.56.36-.44.24-.82.6-1.14 1.08v-1.2c0-1.08-.34-1.88-1.02-2.4-.68-.52-1.58-.78-2.7-.78-1.04 0-1.9.22-2.58-.66-.68-.44-1.12-1.02-1.32-1.74l-3.3.42c.44 1.44 1.28 2.54 2.52 3.3.24.16.5.28.78.38.28.08.58.14.88.16.3.02.6.02.9.02Z" fill="#179BD7"></path><path d="M44.425 3.566c1.12 0 2.02.26 2.7.78.68.52 1.02 1.32 1.02 2.4v.42h-3.92c-1.2 0-2.1.28-2.7.84-.6.56-.9 1.42-.9 2.58v4.2c0 1.16.3 2.02.9 2.58.6.56 1.5.84 2.7.84h3.92v.42c0 1.08-.34 1.88-1.02 2.4-.68.52-1.58.78-2.7.78-1.04 0-1.9-.22-2.58-.66-.68-.44-1.12-1.02-1.32-1.74l-3.3.42c.44 1.44 1.28 2.54 2.52 3.3.24.16.5.28.78.38.28.08.58.14.88.16.3.02.6.02.9.02 1.76 0 3.16-.36 4.2-1.08 1.04-.72 1.56-1.8 1.56-3.24v-6.9c.28-.48.64-.86 1.08-1.14.44-.28.92-.42 1.44-.42h.36v-2.82h-.9c-.6 0-1.12.12-1.56.36-.44.24-.82.6-1.14 1.08v-1.2c0-1.08-.34-1.88-1.02-2.4-.68-.52-1.58-.78-2.7-.78-1.04 0-1.9.22-2.58-.66-.68-.44-1.12-1.02-1.32-1.74l-3.3.42c.44 1.44 1.28 2.54 2.52 3.3.24.16.5.28.78.38.28.08.58.14.88.16.3.02.6.02.9.02Z" fill="#179BD7"></path><path d="M64.607 3.326c-.64.16-1.18.5-1.62 1.02-.44.52-.75 1.18-.93 1.98-.18.8-.27 1.78-.27 2.94v.9c0 1.52.32 2.8.96 3.84.64 1.04 1.62 1.56 2.94 1.56h.9v-1.74h-.72c-.88 0-1.52-.22-1.92-.66-.4-.44-.6-1.08-.6-1.92v-3.48h4.22v-2.82h-2.84v-.6c0-.84.2-1.46.6-1.86s.98-.6 1.74-.6h.72v-1.74h-1.86Z" fill="#179BD7"></path></svg>
              </div>
              
              <!-- Body -->
              <div class="p-6">
                <p class="text-center text-slate-600 mb-4">{{hotel.name}}</p>
                <p class="text-center text-4xl font-bold text-slate-800 mb-6">${{totalCost()}}</p>
                
                @if(payPalStep() === 'login') {
                  <div class="space-y-4">
                    <input type="email" placeholder="Email or mobile number" class="w-full border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-slate-100 cursor-not-allowed" value="traveler@example.com" disabled>
                    <input type="password" placeholder="Password" class="w-full border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-slate-100 cursor-not-allowed" value="********" disabled>
                    <button (click)="simulatePayPalLogin()" class="w-full bg-[#0070BA] text-white py-2.5 rounded-full font-bold text-lg hover:bg-[#005ea6] transition-colors duration-200">
                      Log In
                    </button>
                  </div>
                } @else {
                  <div class="text-center">
                    <p class="text-lg text-slate-700 mb-4">You're logged in as <br><span class="font-medium">traveler@example.com</span></p>
                    <button (click)="confirmPayPalPayment()" class="w-full bg-[#FFC439] text-[#003057] py-2.5 rounded-full font-bold text-lg hover:bg-[#f0b72f] transition-colors duration-200">
                      Pay Now
                    </button>
                  </div>
                }
              </div>
            </div>
          } @else {
            <!-- Fallback if hotel is not selected, which shouldn't happen in this flow -->
            <p>Loading payment details...</p>
          }
        </div>
      }

      <!-- PAYMENT PROCESSING VIEW -->
      @case ('payment') {
        <div class="max-w-md mx-auto text-center">
          <div class="bg-white p-10 rounded-lg shadow-xl">
             <div class="w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-6"></div>
             <h2 class="text-2xl font-bold text-slate-800 mb-2">Processing Payment</h2>
             <p class="text-slate-600">{{ paymentProcessingMessage() }}</p>
          </div>
        </div>
      }

      <!-- CONFIRMATION VIEW -->
      @case ('confirmation') {
        @if (selectedHotel(); as hotel) {
          <div class="max-w-2xl mx-auto text-center">
            <div class="bg-white p-10 rounded-lg shadow-xl">
              <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <svg class="w-12 h-12 text-green-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
              </div>
              <h2 class="text-3xl font-bold text-slate-900 mb-2">Booking Confirmed!</h2>
              <p class="text-lg text-slate-600 mb-6">Your stay at <span class="font-semibold">{{ hotel.name }}</span> is booked and paid for.</p>
              <div class="text-left bg-slate-50 rounded-lg p-6 space-y-2">
                 <p><strong class="w-24 inline-block">Hotel:</strong> {{ hotel.name }}</p>
                 <p><strong class="w-24 inline-block">Location:</strong> {{ hotel.location }}</p>
                 <p><strong class="w-24 inline-block">Nights:</strong> {{ bookingNights() }}</p>
                 <p><strong class="w-24 inline-block">Guests:</strong> {{ bookingGuests() }}</p>
                 <p><strong class="w-24 inline-block">Total Paid:</strong> <span class="font-bold">${{ totalCost() }}</span></p>
              </div>
              
              <div class="mt-6 mb-8 flex items-center justify-center bg-blue-50 text-blue-700 p-4 rounded-lg text-sm">
                <svg class="w-5 h-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
                </svg>
                <p>A confirmation email with your booking details has been sent.</p>
              </div>

              <button (click)="startNewBooking()" class="bg-blue-600 text-white px-8 py-3 rounded-md font-semibold hover:bg-blue-700 transition-colors duration-200">
                Book Another Stay
              </button>
            </div>
          </div>
        }
      }
    }
  </main>
</div>
